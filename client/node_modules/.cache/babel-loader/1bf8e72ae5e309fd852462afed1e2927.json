{"ast":null,"code":"const passport = require('passport');\n\nconst LocalStrategy = require('./localStrategy');\n\nconst User = require('../models/user'); // called on login, saves the id to session req.session.passport.user = {id:'..'}\n\n\npassport.serializeUser((user, done) => {\n  console.log('*** serializeUser called, user: ');\n  console.log(user); // the whole raw user object!\n\n  console.log('---------');\n  done(null, {\n    _id: user._id\n  });\n}); // user object attaches to the request as req.user\n\npassport.deserializeUser((id, done) => {\n  console.log('DeserializeUser called');\n  User.findOne({\n    _id: id\n  }, 'username', (err, user) => {\n    console.log('*** Deserialize user, user:');\n    console.log(user);\n    console.log('--------------');\n    done(null, user);\n  });\n}); //  Use Strategies \n\npassport.use(LocalStrategy);\nmodule.exports = passport;","map":null,"metadata":{},"sourceType":"script"}