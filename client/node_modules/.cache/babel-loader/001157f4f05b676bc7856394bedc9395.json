{"ast":null,"code":"const User = require('../models/user');\n\nconst LocalStrategy = require('passport-local').Strategy;\n\nconst strategy = new LocalStrategy({\n  usernameField: 'username' // not necessary, DEFAULT\n\n}, function (username, password, done) {\n  User.findOne({\n    username: username\n  }, (err, user) => {\n    if (err) {\n      return done(err);\n    }\n\n    if (!user) {\n      return done(null, false, {\n        message: 'Incorrect username'\n      });\n    }\n\n    if (!user.checkPassword(password)) {\n      return done(null, false, {\n        message: 'Incorrect password'\n      });\n    }\n\n    return done(null, user);\n  });\n});\nmodule.exports = strategy;","map":null,"metadata":{},"sourceType":"script"}